# Generated by Chef
[global]
  auth supported = cephx
  ms bind ipv6 = true
  keyring = /etc/ceph/$name.keyring

[mon]
  mon data = /srv/ceph/mon.$id
<% node["ceph"]["config"]["mon"].each do |key, value| -%>
  <%= key %> = <%= value %>
<% end -%>

<% @monitors.each do |monitor, address| -%>
[mon.<%= monitor %>]
  host = <%= monitor %>
  mon addr = [<%= address %>]

<% end -%>

<% if (! node["ceph"]["config"]["mds"].nil?) -%>
[mds]
  <% node["ceph"]["config"]["mds"].each do |key, value| -%>
  <%= key %> = <%= value %>
<%   end -%>
<% end -%>

[osd]
  btrfs devs = /srv/ceph/devices/osd.$id.data
  osd journal = /srv/ceph/devices/osd.$id.journal
  keyring = /srv/ceph/osd/$id/keyring
  osd data = /srv/ceph/osd/$id
  admin socket = /var/run/ceph/ceph-$name.asok
<% node["ceph"]["config"]["osd"].each do |key, value| -%>
  <%= key %> = <%= value %>
<% end -%>

<% @osd_devices.each do |osd_device| -%>
[osd.<%= osd_device['osd_id'] %>]
  host = <%= node[:hostname] %>
  public addr = <%= @public_ip %>
  cluster addr = <%= @cluster_ip %>

<% end -%>

<% if ( @is_radosgw == 1 ) then -%>
[client.radosgw.<%= node[:hostname] %>]
  log file = /var/log/ceph/$id.log
  rgw socket path = /var/run/ceph/radosgw.client.radosgw.<%= node[:hostname] %>
  rgw swift url = https://<%= node["ceph"]["api_fqdn"] %>
  rgw swift url prefix = swift
  rgw dns name = <%= node["ceph"]["api_fqdn"] %>
<% node["ceph"]["config"]["rgw"].each do |key, value| -%>
  <%= key %> = <%= value %>
<%   end -%>
<% end -%>

# This must be the last line and will be ignored
